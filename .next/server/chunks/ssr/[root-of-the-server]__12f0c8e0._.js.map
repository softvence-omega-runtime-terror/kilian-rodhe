{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///media/betopia/New%20Volume/HOME/Projects_Akash/kilian-rodhe-last-/app/store/slices/authSlice.ts"],"sourcesContent":["import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport type { PersistPartial } from \"redux-persist/es/persistReducer\";\n\n/* ================= TYPES ================= */\n\nexport interface Profile {\n  first_name?: string;\n  last_name?: string;\n  phone_number?: string;\n  image?: string;\n  [key: string]: any;\n}\n\nexport interface User {\n  id: number;\n  email: string;\n  profile?: Profile;\n  [key: string]: any;\n}\n\nexport interface AuthState {\n  user: User | null;\n  access: string | null;\n  refresh: string | null;\n  isAuthenticated: boolean;\n  isLoading: boolean;\n}\n\n/* ================= INITIAL STATE ================= */\n\nconst initialState: AuthState = {\n  user: null,\n  access: null,\n  refresh: null,\n  isAuthenticated: false,\n  isLoading: false,\n};\n\n/* ================= HELPERS ================= */\n\n/** Clean string values (remove surrounding quotes if backend returns them) */\nfunction cleanString(str?: string): string | null {\n  if (!str) return null;\n  if (str.startsWith('\"') && str.endsWith('\"')) return str.slice(1, -1);\n  return str;\n}\n\n/** Safely parse user from string or object and merge profile immutably */\nfunction parseUser(user: User | string | undefined, profile?: Profile): User | null {\n  if (!user) return null;\n\n  let parsed: User;\n  if (typeof user === \"string\") {\n    try {\n      parsed = JSON.parse(user) as User;\n    } catch {\n      parsed = { id: 0, email: \"\" }; // fallback\n    }\n  } else {\n    parsed = user;\n  }\n\n  // ðŸ”‘ Return a NEW object, never mutate original\n  return {\n    ...parsed,\n    profile: profile ? { ...profile } : parsed.profile,\n  };\n}\n\n/* ================= SLICE ================= */\n\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState,\n  reducers: {\n    /** Login / Set credentials */\n    setCredentials: (\n      state,\n      action: PayloadAction<{\n        user: User | string;\n        profile?: Profile;\n        access: string;\n        refresh: string;\n      }>\n    ) => {\n      state.user = parseUser(action.payload.user, action.payload.profile);\n      state.access = cleanString(action.payload.access);\n      state.refresh = cleanString(action.payload.refresh);\n      state.isAuthenticated = true;\n    },\n\n    /** Logout user */\n    logout: (state) => {\n      state.user = null;\n      state.access = null;\n      state.refresh = null;\n      state.isAuthenticated = false;\n    },\n\n    /** Optional: set loading state */\n    setLoading: (state, action: PayloadAction<boolean>) => {\n      state.isLoading = action.payload;\n    },\n  },\n});\n\n/* ================= EXPORTS ================= */\n\nexport const { setCredentials, logout, setLoading } = authSlice.actions;\nexport default authSlice.reducer;\n\n/* ================= SELECTORS ================= */\n\nexport const selectAuth = (state: { auth: AuthState & PersistPartial }) => state.auth;\nexport const selectAccess = (state: { auth: AuthState & PersistPartial }) => state.auth.access;\nexport const selectRefresh = (state: { auth: AuthState & PersistPartial }) => state.auth.refresh;\nexport const selectUser = (state: { auth: AuthState & PersistPartial }) => state.auth.user;\nexport const selectIsAuthenticated = (state: { auth: AuthState & PersistPartial }) => state.auth.isAuthenticated;\nexport const selectIsLoading = (state: { auth: AuthState & PersistPartial }) => state.auth.isLoading;\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;;AA4BA,qDAAqD,GAErD,MAAM,eAA0B;IAC9B,MAAM;IACN,QAAQ;IACR,SAAS;IACT,iBAAiB;IACjB,WAAW;AACb;AAEA,+CAA+C,GAE/C,4EAA4E,GAC5E,SAAS,YAAY,GAAY;IAC/B,IAAI,CAAC,KAAK,OAAO;IACjB,IAAI,IAAI,UAAU,CAAC,QAAQ,IAAI,QAAQ,CAAC,MAAM,OAAO,IAAI,KAAK,CAAC,GAAG,CAAC;IACnE,OAAO;AACT;AAEA,wEAAwE,GACxE,SAAS,UAAU,IAA+B,EAAE,OAAiB;IACnE,IAAI,CAAC,MAAM,OAAO;IAElB,IAAI;IACJ,IAAI,OAAO,SAAS,UAAU;QAC5B,IAAI;YACF,SAAS,KAAK,KAAK,CAAC;QACtB,EAAE,OAAM;YACN,SAAS;gBAAE,IAAI;gBAAG,OAAO;YAAG,GAAG,WAAW;QAC5C;IACF,OAAO;QACL,SAAS;IACX;IAEA,gDAAgD;IAChD,OAAO;QACL,GAAG,MAAM;QACT,SAAS,UAAU;YAAE,GAAG,OAAO;QAAC,IAAI,OAAO,OAAO;IACpD;AACF;AAEA,6CAA6C,GAE7C,MAAM,YAAY,IAAA,0MAAW,EAAC;IAC5B,MAAM;IACN;IACA,UAAU;QACR,4BAA4B,GAC5B,gBAAgB,CACd,OACA;YAOA,MAAM,IAAI,GAAG,UAAU,OAAO,OAAO,CAAC,IAAI,EAAE,OAAO,OAAO,CAAC,OAAO;YAClE,MAAM,MAAM,GAAG,YAAY,OAAO,OAAO,CAAC,MAAM;YAChD,MAAM,OAAO,GAAG,YAAY,OAAO,OAAO,CAAC,OAAO;YAClD,MAAM,eAAe,GAAG;QAC1B;QAEA,gBAAgB,GAChB,QAAQ,CAAC;YACP,MAAM,IAAI,GAAG;YACb,MAAM,MAAM,GAAG;YACf,MAAM,OAAO,GAAG;YAChB,MAAM,eAAe,GAAG;QAC1B;QAEA,gCAAgC,GAChC,YAAY,CAAC,OAAO;YAClB,MAAM,SAAS,GAAG,OAAO,OAAO;QAClC;IACF;AACF;AAIO,MAAM,EAAE,cAAc,EAAE,MAAM,EAAE,UAAU,EAAE,GAAG,UAAU,OAAO;uCACxD,UAAU,OAAO;AAIzB,MAAM,aAAa,CAAC,QAAgD,MAAM,IAAI;AAC9E,MAAM,eAAe,CAAC,QAAgD,MAAM,IAAI,CAAC,MAAM;AACvF,MAAM,gBAAgB,CAAC,QAAgD,MAAM,IAAI,CAAC,OAAO;AACzF,MAAM,aAAa,CAAC,QAAgD,MAAM,IAAI,CAAC,IAAI;AACnF,MAAM,wBAAwB,CAAC,QAAgD,MAAM,IAAI,CAAC,eAAe;AACzG,MAAM,kBAAkB,CAAC,QAAgD,MAAM,IAAI,CAAC,SAAS","debugId":null}},
    {"offset": {"line": 102, "column": 0}, "map": {"version":3,"sources":["file:///media/betopia/New%20Volume/HOME/Projects_Akash/kilian-rodhe-last-/app/store/slices/services/baseBackendApi.ts"],"sourcesContent":["import { createApi, fetchBaseQuery } from \"@reduxjs/toolkit/query/react\";\nimport type { PersistPartial } from \"redux-persist/es/persistReducer\";\nimport { AuthState } from \"../authSlice\";\n\nexport const baseBackendApi = createApi({\n  reducerPath: \"baseBackendApi\",\n\n  baseQuery: fetchBaseQuery({\n    baseUrl: process.env.NEXT_PUBLIC_API_BASE_URL,\n\n    prepareHeaders: (headers, { getState }) => {\n      const state = getState() as {\n        auth: AuthState & PersistPartial;\n      };\n\n      const token = state.auth.access;\n      if (token) {\n        headers.set(\"Authorization\", `Bearer ${token}`);\n      }\n\n      return headers;\n    },\n\n    credentials: \"include\",\n  }),\n\n  tagTypes: [\"Products\", \"Users\", \"Orders\"],\n\n  endpoints: () => ({}),\n});\n"],"names":[],"mappings":";;;;AAAA;AAAA;;AAIO,MAAM,iBAAiB,IAAA,+NAAS,EAAC;IACtC,aAAa;IAEb,WAAW,IAAA,kMAAc,EAAC;QACxB,OAAO;QAEP,gBAAgB,CAAC,SAAS,EAAE,QAAQ,EAAE;YACpC,MAAM,QAAQ;YAId,MAAM,QAAQ,MAAM,IAAI,CAAC,MAAM;YAC/B,IAAI,OAAO;gBACT,QAAQ,GAAG,CAAC,iBAAiB,CAAC,OAAO,EAAE,OAAO;YAChD;YAEA,OAAO;QACT;QAEA,aAAa;IACf;IAEA,UAAU;QAAC;QAAY;QAAS;KAAS;IAEzC,WAAW,IAAM,CAAC,CAAC,CAAC;AACtB","debugId":null}},
    {"offset": {"line": 134, "column": 0}, "map": {"version":3,"sources":["file:///media/betopia/New%20Volume/HOME/Projects_Akash/kilian-rodhe-last-/app/store/index.ts"],"sourcesContent":["import { configureStore } from \"@reduxjs/toolkit\";\nimport { setupListeners } from \"@reduxjs/toolkit/query\";\nimport { persistReducer, persistStore } from \"redux-persist\";\nimport storage from \"redux-persist/lib/storage\";\n\nimport authReducer from \"./slices/authSlice\";\nimport { baseBackendApi } from \"./slices/services/baseBackendApi\";\n\n/* ================= PERSIST CONFIG ================= */\n\nconst authPersistConfig = {\n  key: \"auth\",\n  storage,\n  whitelist: [\"user\", \"access\", \"refresh\", \"isAuthenticated\"],\n};\n\nconst persistedAuthReducer = persistReducer(\n  authPersistConfig,\n  authReducer\n);\n\n/* ================= STORE ================= */\n\nexport const store = configureStore({\n  reducer: {\n    auth: persistedAuthReducer,\n    [baseBackendApi.reducerPath]: baseBackendApi.reducer,\n  },\n\n  middleware: (getDefaultMiddleware) =>\n    getDefaultMiddleware({\n      serializableCheck: false,\n    }).concat(baseBackendApi.middleware),\n\n  devTools: process.env.NODE_ENV !== \"production\",\n});\n\nsetupListeners(store.dispatch);\n\n/* ================= TYPES ================= */\n\nexport type RootState = ReturnType<typeof store.getState>;\nexport type AppDispatch = typeof store.dispatch;\n\nexport const persistor = persistStore(store);\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAEA;AACA;;;;;;;AAEA,sDAAsD,GAEtD,MAAM,oBAAoB;IACxB,KAAK;IACL,SAAA,sKAAO;IACP,WAAW;QAAC;QAAQ;QAAU;QAAW;KAAkB;AAC7D;AAEA,MAAM,uBAAuB,IAAA,uNAAc,EACzC,mBACA,8IAAW;AAKN,MAAM,QAAQ,IAAA,6MAAc,EAAC;IAClC,SAAS;QACP,MAAM;QACN,CAAC,sKAAc,CAAC,WAAW,CAAC,EAAE,sKAAc,CAAC,OAAO;IACtD;IAEA,YAAY,CAAC,uBACX,qBAAqB;YACnB,mBAAmB;QACrB,GAAG,MAAM,CAAC,sKAAc,CAAC,UAAU;IAErC,UAAU,oDAAyB;AACrC;AAEA,IAAA,kMAAc,EAAC,MAAM,QAAQ;AAOtB,MAAM,YAAY,IAAA,iNAAY,EAAC","debugId":null}},
    {"offset": {"line": 181, "column": 0}, "map": {"version":3,"sources":["file:///media/betopia/New%20Volume/HOME/Projects_Akash/kilian-rodhe-last-/app/ReduxProvider.tsx"],"sourcesContent":["\"use client\"; // client component\n\nimport { ReactNode } from \"react\";\nimport { Provider } from \"react-redux\";\nimport { PersistGate } from \"redux-persist/integration/react\";\nimport { persistor, store } from \"./store\";\n\nexport default function ReduxProvider({ children }: { children: ReactNode }) {\n  return (\n    <Provider store={store}>\n      <PersistGate loading={null} persistor={persistor}>\n        {children}\n      </PersistGate>\n    </Provider>\n  );\n}\n"],"names":[],"mappings":";;;;;AAGA;AACA;AACA;AALA,cAAc,mBAAmB;;;;;AAOlB,SAAS,cAAc,EAAE,QAAQ,EAA2B;IACzE,qBACE,8OAAC,qKAAQ;QAAC,OAAO,8HAAK;kBACpB,cAAA,8OAAC,6KAAW;YAAC,SAAS;YAAM,WAAW,kIAAS;sBAC7C;;;;;;;;;;;AAIT","debugId":null}}]
}